# Stress æ¨¡æ‹Ÿ CPU/Mem/IO å‹åŠ›(è´Ÿè½½)

æœ¬æ–‡ä¸»è¦è®°å½•å¦‚ä½•ä½¿ç”¨ Stress å·¥å…·åœ¨ Linux ä¸­æ¨¡æ‹Ÿ CPU / Mem / IO / Network å‹åŠ›,ä»¥è¿›è¡Œå¯¹åº”æµ‹è¯•ã€‚



## å®‰è£… & ä½¿ç”¨

```Bash
yum install -y epel-release  
yum install stress -y
```

ç›¸å…³å‚æ•°ä½¿ç”¨`stress --help` æŸ¥çœ‹å³å¯ï¼š

```Bash
-c, --cpu N            äº§ç”Ÿ N ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åå¤ä¸åœçš„è®¡ç®—éšæœºæ•°çš„å¹³æ–¹æ ¹
-i, --io N             äº§ç”Ÿ N ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åå¤è°ƒç”¨ sync () å°†å†…å­˜ä¸Šçš„å†…å®¹å†™åˆ°ç¡¬ç›˜ä¸Š
-m, --vm N             äº§ç”Ÿ N ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸æ–­åˆ†é…å’Œé‡Šæ”¾å†…å­˜
--vm-bytes B      æŒ‡å®šåˆ†é…å†…å­˜çš„å¤§å°
--vm-stride B     ä¸æ–­çš„ç»™éƒ¨åˆ†å†…å­˜èµ‹å€¼ï¼Œè®© COW (Copy On Write) å‘ç”Ÿ
--vm-hang N      æŒ‡ç¤ºæ¯ä¸ªæ¶ˆè€—å†…å­˜çš„è¿›ç¨‹åœ¨åˆ†é…åˆ°å†…å­˜åè½¬å…¥ç¡çœ çŠ¶æ€ N ç§’ï¼Œç„¶åé‡Šæ”¾å†…å­˜ï¼Œä¸€ç›´é‡å¤æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹
--vm-keep          ä¸€ç›´å ç”¨å†…å­˜ï¼ŒåŒºåˆ«äºä¸æ–­çš„é‡Šæ”¾å’Œé‡æ–°åˆ†é… (é»˜è®¤æ˜¯ä¸æ–­é‡Šæ”¾å¹¶é‡æ–°åˆ†é…å†…å­˜)
-d, --hdd N           äº§ç”Ÿ N ä¸ªä¸æ–­æ‰§è¡Œ write å’Œ unlink å‡½æ•°çš„è¿›ç¨‹ (åˆ›å»ºæ–‡ä»¶ï¼Œå†™å…¥å†…å®¹ï¼Œåˆ é™¤æ–‡ä»¶)
--hdd-bytes B  æŒ‡å®šæ–‡ä»¶å¤§å°
-t, --timeout N       åœ¨ N ç§’åç»“æŸç¨‹åº        
--backoff N            ç­‰å¾… N å¾®å¦™åå¼€å§‹è¿è¡Œ
-q, --quiet           ç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¸è¾“å‡ºä¿¡æ¯
-n, --dry-run          è¾“å‡ºç¨‹åºä¼šåšä»€ä¹ˆè€Œå¹¶ä¸å®é™…æ‰§è¡Œç›¸å…³çš„æ“ä½œ
--version              æ˜¾ç¤ºç‰ˆæœ¬å·-v, --verbose          æ˜¾ç¤ºè¯¦ç»†çš„ä¿¡æ¯
```

## æ¨¡æ‹Ÿ CPU è´Ÿè½½

```Bash
# é€šè¿‡ -c æŒ‡å®šéœ€è¦å ç”¨çš„æ ¸æ•°ï¼Œä¼šç›´æ¥å ç”¨ 100%
stress -c 2
```

æ²¡æœ‰ stress ä¹Ÿå¯ä»¥ä½¿ç”¨åŸç”Ÿå‘½ä»¤æ¥å®ç°ã€‚

å¯¹éšæœºæ•°è¿›è¡Œå‹ç¼©ä¸è§£å‹ï¼Œéœ€è¦å ç”¨å‡ ä¸ªæ ¸ï¼Œå°±æŒ‡å®šå‡ ç»„`gzip -9 | gzip -d`ã€‚ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå°±ä¼šå ç”¨ 2 ä¸ªæ ¸ï¼š

```Bash
# 2 æ ¸
cat /dev/urandom | gzip -9 | gzip -d | gzip -9 | gzip -d  > /dev/null

# 4 æ ¸å¿ƒ
cat /dev/urandom | gzip -9 | gzip -d | gzip -9 | gzip -d | gzip -9 | gzip -d | gzip -9 | gzip -d  > /dev/null
```

> æµ‹è¯•ä¸‹æ¥ä¸ä¼šå ç”¨åˆ° 100%ï¼Œä¸€èˆ¬æ˜¯ 95% å·¦å³ï¼Œå¯ä»¥å¤šæŒ‡å®šå‡ ç»„`gzip -9 | gzip -d` æ¥å®ç° 100% å ç”¨ã€‚

## æ¨¡æ‹Ÿå†…å­˜è´Ÿè½½

> æ³¨æ„ğŸ“¢ï¼šStress æ¨¡æ‹Ÿå†…å­˜å‹åŠ›åŒæ—¶ä¹Ÿä¼šå ç”¨ cpu

æ¨¡æ‹Ÿäº§ç”Ÿ 2 ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åˆ†é… 1G å†…å­˜ï¼ŒæŒç»­ 30s

```Bash
stress --vm 2 --vm-keep
```

## æ¨¡æ‹Ÿç£ç›˜å†™å…¥

```Bash
stress -d 2
```

## æ¨¡æ‹Ÿå¤§é‡ IO æ“ä½œ

```Bash
stress -i 2
```